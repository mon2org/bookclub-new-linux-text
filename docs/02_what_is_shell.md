---
title: "第02章 シェルって何だろう？"
date: 2026-01-12T22:00:00
draft: false
---

# 第02章 シェルって何だろう？

## 要点
Linuxにおけるシェルとコマンド操作の基礎

### 1. シェルの基本概念と役割

- Linuxにおける操作は、WindowsやmacOSのようなグラフィカルユーザーインターフェース（GUI）とは異なり、キーボードからのコマンド入力が基本となる。
- このコマンドベースの操作を実現する上で中心的な役割を果たすのが「シェル」である。
  - シェルとは、ユーザーとLinuxカーネル（OSの中核部分）の間に位置し、両者の対話を仲介するソフトウェア。
  - ユーザーがキーボードから入力したコマンド文字列をシェルが受け取り、それをカーネルが理解できる形式に解釈して実行を依頼する。
  - カーネルからの実行結果は再びシェルに返され、シェルがそれを画面に出力することでユーザーに提示される。
- 本書で主に取り扱うのは、数あるシェルの中でも特に広く利用されている「Bash」である。
- シェルのプロンプト（多くは$記号で示される）の後ろにコマンドを入力し、Enterキーを押すことで、様々な処理を実行できる。
- Linuxには、最小構成でも数百のコマンドが用意されている。
- これら一つ一つは単純な機能を持つが、組み合わせて使用することで極めて複雑で強力な処理を実現できるのがLinuxの大きな特徴である。

### エラーメッセージの重要性

- コマンドの入力ミスや存在しないコマンドを実行しようとすると、シェルはエラーメッセージを表示する。
- 例：存在しないコマンドABCXYZを入力した場合
  ```bash
  bash: ABCXYZ: command not found
  ```
- このメッセージは、ABCXYZという名前のコマンドが見つからなかったことを示している。

### シェルとカーネルのアーキテクチャ

- シェルとカーネルの役割が明確に分離されているのは、Linuxの設計思想に基づく意図的な構造である。
- ユーザーがdateコマンドを実行する際、内部では以下の処理が行われる。
  1. 入力受付: シェルがキーボードから入力されたdateという文字列を受け取る。
  2. コマンド探索: シェルがdateという名前のコマンドを探す。
  3. 実行依頼: 見つかったコマンドをLinuxカーネルに実行依頼する。この部分はOSの中核であるカーネルが担当する。
  4. 結果表示: カーネルがコマンドを実行し、得られた結果（日時の文字列）をシェルに返す。シェルがその結果を画面に表示する。
- カーネルにコマンド操作機能を含めず、シェルとして独立させていることには、以下の重要な利点がある。
  * カスタマイズ性: OS本体であるカーネルを変更することなく、ユーザーは好みのシェルに自由に変更できる。
  * 移植性: シェルが他のOS（例: BSD, Solaris）に移植されていれば、ユーザーはOSが変わっても同じ操作感を維持できる。
  * 堅牢性: シェルがエラーや不具合でクラッシュしても、影響はシェル内に留まり、OS本体であるカーネルへのダメージを最小限に抑えることができる。
これは、「一つのプログラムには一つのことをうまくやらせる」というLinuxの基本的な設計思想を体現しており、ソフトウェア開発における重要な原則でもある。

### シェルの操作環境
プロンプトは、シェルがユーザーからのコマンド入力を待機していることを示す記号である。一般的に、ユーザーの種類によって表示が異なる。

| ユーザーの種類 | プロンプト記号 | 説明 |
| --- | --- | --- |
| 一般ユーザー | $ | 通常の操作を行うユーザー。 |
| スーパーユーザー (root) | # | システム全体に対する権限を持つ管理者ユーザー。 |

この記法は、多くのLinux関連ドキュメントで共通して用いられるため、覚えておく必要がある。

- シェルの利用方法には、大きく分けて二つの形態がある。
* 対話型操作 (Interactive Operation): ユーザーがキーボードから都度コマンドを入力し、結果を確認しながら作業を進める方法。
* シェルスクリプト: 実行したい一連のコマンドをあらかじめファイルに記述しておき、そのファイルを指定することでまとめて自動実行する方法。単純なコマンドの組み合わせで複雑な自動処理プログラムを作成できる、非常に強力な機能である。

#### ログインシェル
- ユーザーがシステムにログインした際に、自動的に最初に起動されるシェルのことを「ログインシェル」と呼ぶ。
- 多くのLinux環境では、このログインシェルとしてBashがデフォルトで設定されている。
- 現在使用しているログインシェルは、以下のコマンドで確認できる。
  ```bash
  $ echo $SHELL
  /bin/bash
  ```

#### 主要なシェルの種類

LinuxではBash以外にも様々なシェルが利用可能であり、それぞれに特徴がある。

|シェル名|通称|特徴|
|---|---|---|
|sh|Bourne Shell, B-Shell|最も古くから存在する標準的なシェル。多くのOSで利用可能。シェルスクリプトの記述に今も広く使われるが、対話型操作は不便。|
|csh|C Shell|対話型操作の利便性で人気があったが、スクリプト記述に構造的な欠陥がある。現在では後継のtcshに取って代わられている。|
|bash|Bourne-Again Shell|本書推奨。shを拡張し、後方互換性を持つ。対話型・スクリプト共に高機能で、多くのLinuxでデフォルト。|
|tcsh|-|cshの後継。対話型操作は便利だが、スクリプトには不向き。プロンプトは%が一般的。|
|zsh|Z Shell|比較的新しく、bashやtcshの機能を取り込んだ非常に高機能なシェル。macOSのデフォルト。|
|fish|Friendly Interactive Shell|ユーザーフレンドリーさを重視。初心者でも使いやすいが、他のシェルとの文法互換性はない。|

#### Bashを推奨する理由

本書がBashの利用を強く推奨する理由は、欠点がほとんどない一方で多くの利点を持つためである。
* 普及率: 多くのLinux環境でデフォルト採用されており、利用機会が非常に多い。
* 機能性: 対話型操作とシェルスクリプト作成の両方で十分な機能を持つ。
* 互換性: shとの後方互換性があり、既存のshスクリプトをそのまま実行できる。
* 情報量: 利用者が多いため、Webなどで情報を得やすい。

#### シェルの一時的な切り替え方法

現在のシェルから、一時的に別のシェルを利用することができる。シェルの名前自体がコマンドになっているため、プロンプトから実行したいシェルの名前を入力するだけで起動する。

例：Bashからshに切り替える
```bash
$ sh
$  ←プロンプトが変化
```

元のシェルに戻るにはexitコマンドを使用する。

シェルを多重に起動した場合は、起動した回数だけexitを実行する必要がある。

ログインシェル自体の恒久的な変更にはchshコマンドがあるが、操作を誤るとログイン不能になるリスクがあるため、特別な理由がない限りデフォルトのBashを使い続けることが推奨される。

### ターミナルとシェルの関係

「ターミナル」と「シェル」は混同されがちだが、全く異なるソフトウェアである。

#### ターミナルとターミナルエミュレーター

* ターミナル: 本来は、コンピューターへの入出力（キーボード入力とディスプレイ表示）を行うための専用ハードウェアを指す。
* ターミナルエミュレーター: 現在主流となっているのは、この物理的なターミナルをソフトウェアで擬似的に実現したものである。WindowsやmacOS上で動作するアプリケーションとして提供される。
  * 代表的なターミナルエミュレーター:
    * Windows: Windows Terminal, PuTTY, Tera Term
    * macOS: ターミナル, iTerm2
    * Linux: GNOME 端末, Konsole

#### シェルとの明確な違い
ターミナルエミュレーターは、あくまで入出力のための「画面」を提供するソフトウェアである。
一方、シェルはその「画面」の中で動作し、ユーザーからの入力を受け取ってコマンドを解釈・実行するソフトウェアである。
例えば、Windows PCからリモートのLinuxマシンに接続して操作する場合、ターミナルエミュレーターは手元のWindows上で動作し、シェルは接続先のLinuxマシン上で動作している。

### 補足：ソフトウェアライセンス

LinuxカーネルはGNU General Public License (GPL) というライセンスを採用している。これはオープンソースソフトウェアで広く用いられるライセンス形態の一つである。

* GNU GPLの主な特徴:
  * プログラムの複製、改変、再配布を自由に行うことができる。
  * GPLのソフトウェアを改変して作成した派生物を配布する場合、その派生物も同じGPLライセンスで配布し、かつソースコードを公開しなければならないという強い制約（コピーレフト）がある。

***
[🔙 ](./README.md)
